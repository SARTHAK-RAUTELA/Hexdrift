window.expLibraryDataQueue = window.expLibraryDataQueue || [];
window.expLibraryDataQueue.push({
    TravelShift_T54: {
        var: {
            pathname: window.location.pathname,
            imageMap: [
                { id: "20", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/NorthernLights.png", alt: "NorthernLights" },
                { id: "367", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/iceCaving.png", alt: "iceCaving" },
                { id: "370", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/SelfDrive.png", alt: "SelfDrive" },
                { id: "2", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/Glacierhiking.png", alt: "Glacierhiking" },
                { id: "15", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/Sightseeing.png", alt: "Sightseeing" },
                { id: "14", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/WhaleWatching.png", alt: "WhaleWatching" },
                { id: "251", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/hotSpringBathing.png", alt: "hotSpringBathing" },
                { id: "3", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/snorkelling.png", alt: "snorkelling" },
                { id: "18", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/BoatTrip.png", alt: "BoatTrip" },
                { id: "10", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/SnowMobile.png", alt: "SnowMobile" },
                { id: "4", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/Caving.png", alt: "Caving" },
                { id: "13", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/horseRiding.png", alt: "horseRiding" },
                { id: "374", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/Transfers.png", alt: "Transfers" },
                { id: "366", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/helicopter.png", alt: "helicopter" },
                { id: "371", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/airplane.png", alt: "airplane" },
                { id: "7", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/hiking.png", alt: "hiking" },
                { id: "9", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/ATV.png", alt: "ATV" },
                { id: "230", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/Dogsledding.png", alt: "Dogsledding" },
                { id: "6", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/Canoeing.png", alt: "Canoeing" },
                { id: "5", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/Kayaking.png", alt: "Kayaking" },
                { id: "16", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/Biking.png", alt: "Biking" },
                { id: "19", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/Climbing.png", alt: "Climbing" },
                { id: "377", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/Museums.png", alt: "Museums" },
                { id: "375", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/Walkingtours.png", alt: "Walkingtours" },
                { id: "363", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/CulturalActivity.png", alt: "CulturalActivity" },
                { id: "8", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/Diving.png", alt: "Diving" },
                { id: "1", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/Rafting.png", alt: "Rafting" },
                { id: "378", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/Exhibitions.png", alt: "Exhibitions" },
                { id: "364", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/Fishing.png", alt: "Fishing" },
                { id: "376", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/foodAndDrink.png", alt: "foodAndDrink" },
                { id: "12", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/iceClimbing.png", alt: "iceClimbing" },
                { id: "362", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/Motorbiking.png", alt: "Motorbiking" },
                { id: "373", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/Paragliding.png", alt: "Paragliding" },
                { id: "379", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/PuffinTours.png", alt: "PuffinTours" },
                { id: "380", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/Reindeers.png", alt: "Reindeers" },
                { id: "368", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/Skiing.png", alt: "Skiing" },
                { id: "11", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/Superjeep.png", alt: "Superjeep" },
                { id: "365", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/birdwatching.png", alt: "birdwatching" },
                { id: "372", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/Zipline.png", alt: "Zipline" },
                { id: "381", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/private%2Btour.png", alt: "privatetour" },
                { id: "382", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/shore%2Bexcursions.png", alt: "Shore Excursions" },
                { id: "383", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/baggage%2Bservice.png", alt: "Baggage Service" },

            ],
            imageicon: [
                { value: '', src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/searchIcon54.png", alt: "search" },
                { value: "Northern lights hunting", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/NorthernLightsColor.png", alt: "NorthernLights" },
                { value: "Ice Caving", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/iceCavingColor.png", alt: "iceCaving" },
                { value: "Self drive", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/SelfDriveColor.png", alt: "SelfDrive" },
                { value: "Glacier Hiking", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/GlacierhikingColor.png", alt: "Glacierhiking" },
                { value: "Sightseeing", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/SightseeingColor.png", alt: "Sightseeing" },
                { value: "Whale Watching", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/WhaleWatchingColor.png", alt: "WhaleWatching" },
                { value: "Hot Spring Bathing", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/hotSpringBathingColor.png", alt: "hotSpringBathing" },
                { value: "Snorkelling", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/snorkellingColor.png", alt: "snorkelling" },
                { value: "Boat Trip", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/BoatTripColor.png", alt: "BoatTrip" },
                { value: "Snowmobile", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/SnowMobileColor.png", alt: "SnowMobile" },
                { value: "Caving", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/CavingColor.png", alt: "Caving" },
                { value: "Horse Riding", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/horseRidingColor.png", alt: "horseRiding" },
                { value: "Transfers", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/TransfersColor.png", alt: "Transfers" },
                { value: "Helicopter", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/helicopterColor.png", alt: "helicopter" },
                { value: "Airplane", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/airplaneColor.png", alt: "airplane" },
                { value: "Hiking", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/hikingColor.png", alt: "hiking" },
                { value: "ATV", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/ATVColor.png", alt: "ATV" },
                { value: "Dog sledding", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/DogsleddingColor.png", alt: "Dogsledding" },
                { value: "Canoeing", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/CanoeingColor.png", alt: "Canoeing" },
                { value: "Kayaking", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/KayakingColor.png", alt: "Kayaking" },
                { value: "Biking", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/BikingColor.png", alt: "Biking" },
                { value: "Climbing", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/ClimbingColor.png", alt: "Climbing" },
                { value: "Museums", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/MuseumsColor.png", alt: "Museums" },
                { value: "Walking tours", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/WalkingtoursColor.png", alt: "Walkingtours" },
                { value: "Cultural Activity", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/CulturalActivityColor.png", alt: "CulturalActivity" },
                { value: "Diving", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/DivingColor.png", alt: "Diving" },
                { value: "Rafting", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/RaftingColor.png", alt: "Rafting" },
                { value: "Exhibitions", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/ExhibitionsColor.png", alt: "Exhibitions" },
                { value: "Fishing", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/FishingColor.png", alt: "Fishing" },
                { value: "Food & Drinks", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/foodAndDrinkColor.png", alt: "foodAndDrink" },
                { value: "Ice Climbing", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/iceClimbingColor.png", alt: "iceClimbing" },
                { value: "Motorbiking", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/MotorbikingColor.png", alt: "Motorbiking" },
                { value: "Paragliding", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/ParaglidingColor.png", alt: "Paragliding" },
                { value: "Puffin tours", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/PuffinToursColor.png", alt: "PuffinTours" },
                { value: "Reindeers", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/ReindeersColor.png", alt: "Reindeers" },
                { value: "Skiing", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/SkiingColor.png", alt: "Skiing" },
                { value: "Super Jeep", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/SuperjeepColor.png", alt: "Superjeep" },
                { value: "Bird watching", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/birdwatchingColor.png", alt: "birdwatching" },
                { value: "Zipline", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/ZiplineColor.png", alt: "Zipline" },
                { value: "Private Tour", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/private%2Btour.png", alt: "privatetour" },
                { value: "Shore Excursions", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/shore%2Bexcursions.png", alt: "Shore Excursions" },
                { value: "Baggage Service", src: "https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/baggage%2Bservice.png", alt: "Baggage Service" },

            ],
            iconContainer: `<img src="" alt="" class="Icon_T54" style="display:none">`
        },
        enable_DEBUG: true,
        initOnce: false,
        localDevelopment: true,

        log(message) {
            if (this.enable_DEBUG) console.log(`[DEBUG]: ${message}`);
        },

        safeQuerySelector(selector) {
            try {
                return document.querySelector(selector);
            } catch (error) {
                this.log(`Error in safeQuerySelector: ${error}`);
                return null;
            }
        },

        attachEventHandlers() {
            var $this = this;

            this.log("Adding event listeners");

            this.live('html[lang="en"]  [data-crid="Travel_services_tab"]', 'click', () => {
                setTimeout(() => {
                    $this.init();
                }, 500);
            });
            this.observeSelector('[data-crid="filter-section-activityIds"]', function () {
                const headingSpan = document.querySelector('[data-crid="filter-section-activityIds"] [data-crid="filter-section-heading"] span');
                if (headingSpan !== null && headingSpan.textContent.trim() !== 'Experiences') {
                    headingSpan.textContent = 'Experiences';
                }
                var activity = document.querySelector('[data-crid="filter-section-activityIds"]')
                var attractionIds = document.querySelector('[data-crid="filter-section-attractionIds"]')
                if (activity && !document.querySelector('[data-crid="filter-section-activityIds"]+[data-crid="filter-section-attractionIds"]') && attractionIds) {
                    document.querySelector('[data-crid="filter-section-attractionIds"]').insertAdjacentElement('beforebegin', activity)
                }

            })
            window.addEventListener('travelshift:routeChangeComplete', () => {
                if (!window._travelshift.experiments.some(
                    exp => exp.name === "T54_ACTIVITY_FILTERS_DROPDOWN_EXPERIMENT" && exp.variation === "0"
                )) {
                    (window._travelshift.experiments = window._travelshift.experiments || []).push({ name: "T54_ACTIVITY_FILTERS_DROPDOWN_EXPERIMENT", variation: "0" });
                }
                this.init();

            });

            this.observeSelector('html[lang="en"]  [data-crid="Travel_services_option"]:first-child [type="search"]', function () {
                setTimeout(function () {
                    $this.updateImage();
                }, 300)
            })
            this.observeSelector('html[lang="en"]  #dropdownContainer-trips-activities-idAutocomplete', function () {
                setTimeout(function () {
                    $this.imageMapping()
                }, 300)
            })
            this.observeSelector('html[lang="en"]  #dropdownContainer-autocompleteAutocomplete', function () {
                setTimeout(function () {
                    $this.imageMapping()
                }, 300)

            })
            this.observeSelector('html[lang="en"]  #dropdownContainer-trips-activities-mobile-idAutocomplete', function () {
                setTimeout(function () {
                    $this.imageMapping()
                }, 300)
            })
        },

        imageMapping() {
            var $this = this;
            this.var.imageMap.forEach(function (item) {
                if (window.innerWidth > 960) {
                    $this.runAt('#dropdownContainer-trips-activities-idAutocomplete [data-id] svg', function () {
                        const element = document.querySelector(`#dropdownContainer-trips-activities-idAutocomplete [data-id="${item.id}"] svg`);
                        if (element) {
                            if (!document.querySelector(`#dropdownContainer-trips-activities-idAutocomplete [data-id="${item.id}"] svg+img`)) {
                                element.insertAdjacentHTML('afterend', `<img src="${item.src}" alt="${item.alt}">`);
                            }
                        }
                    })
                }
                else {
                    $this.runAt('#dropdownContainer-trips-activities-mobile-idAutocomplete [data-id] svg', function () {
                        const element = document.querySelector(`#dropdownContainer-trips-activities-mobile-idAutocomplete [data-id="${item.id}"] svg`);
                        if (element) {
                            if (!document.querySelector(`#dropdownContainer-trips-activities-mobile-idAutocomplete [data-id="${item.id}"] svg+img`)) {
                                element.insertAdjacentHTML('afterend', `<img src="${item.src}" alt="${item.alt}">`);
                            }
                        }
                    })
                }
            });
        },

        updateImage() {
            if (window.location.pathname == '/') {
                if (document.querySelector('html[lang="en"]  [name="roundedTabsRadio"]:checked + label') && document.querySelector('html[lang="en"]  [name="roundedTabsRadio"]:checked + label').dataset.frontStepKey == 'tripsCurrentStep') {
                    document.querySelector('body') && document.querySelector('body').classList.add('travelSift-Cs2-Tour');
                } else {
                    if (document.querySelector('body').classList.contains('travelSift-Cs2-Tour')) {
                        document.querySelector('body') && document.querySelector('body').classList.remove('travelSift-Cs2-Tour');
                    }
                }
            }
            let searchInput
            // console.log(searchInput)
            if (window.location.pathname == '/') {
                searchInput = this.safeQuerySelector('html[lang="en"] .travelSift-Cs2-Tour [data-crid="Travel_services_option"]:first-child [type="search"]');
            } else {
                searchInput = this.safeQuerySelector('html[lang="en"]  [data-crid="Travel_services_option"]:first-child [type="search"]');
            }
            const searchValue = searchInput ? searchInput.value.trim() : '';
            const matchedIcon = this.var.imageicon.find(icon => icon.value.toLowerCase() === searchValue.toLowerCase());
            const imageElement = this.safeQuerySelector('.Icon_T54');
            if (imageElement) {
                if (matchedIcon) {
                    imageElement.src = matchedIcon.src;
                    imageElement.alt = matchedIcon.alt;
                } else {
                    imageElement.src = 'https://d27c6j8064skg9.cloudfront.net/ConversionRateExpert/TravelShift/T54/searchIcon54.png';
                    imageElement.alt = 'search';
                }
            }
        },

        init() {
            var $this = this;

            if (!window._travelshift.experiments.some(
                exp => exp.name === "T54_ACTIVITY_FILTERS_DROPDOWN_EXPERIMENT" && exp.variation === "0"
            )) {
                (window._travelshift.experiments = window._travelshift.experiments || []).push({ name: "T54_ACTIVITY_FILTERS_DROPDOWN_EXPERIMENT", variation: "0" });
            }


            $this.runAt('html[lang="en"]  [data-crid="Travel_services_option"]:first-child span>svg', () => {
                setTimeout(() => {
                    if (!$this.safeQuerySelector('.Icon_T54')) {
                        const svgElement = $this.safeQuerySelector('html[lang="en"]  [data-crid="trips-activities-idAutocomplete"]  span>svg');
                        if (svgElement) {
                            svgElement.insertAdjacentHTML("afterend", $this.var.iconContainer);
                        }
                    }
                }, 1000);
            });

            if (window.innerWidth > 960) {
                setTimeout(() => $this.updateImage(), 1000);
            }

        },
    },
});